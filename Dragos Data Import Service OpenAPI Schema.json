{"openapi":"3.0.2","info":{"title":"Dragos Data Import Service","description":"Dragos Data Import Service","version":"1.2.0"},"servers":[{"url":"/ddis"}],"paths":{"/":{"get":{"summary":"Root","description":"DDIS identification endpoint","operationId":"ddis_ident","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RootObject"}}}}}}},"/api/v1/parsers/":{"get":{"tags":["parser"],"summary":"List Parsers","description":"Return sortable list of available parsers.","operationId":"list_parsers","parameters":[{"description":"how many results per page (integer; 0 or unspecified => 100)","required":false,"schema":{"title":"Page Size","minimum":0.0,"type":"integer","description":"how many results per page (integer; 0 or unspecified => 100)","default":0},"name":"page_size","in":"query"},{"description":"which page of results (integer; default 0)","required":false,"schema":{"title":"Page Number","minimum":0.0,"type":"integer","description":"which page of results (integer; default 0)","default":0},"name":"page_number","in":"query"},{"description":"comma-separated list of field name keys to sort on (default unsorted, optionally suffix with :asc [default] or :desc to specify sorting direction). Supported keys [parser_id, name, description, deprecated, namespace, created, updated, user]","required":false,"schema":{"title":"Sort","type":"string","description":"comma-separated list of field name keys to sort on (default unsorted, optionally suffix with :asc [default] or :desc to specify sorting direction). Supported keys [parser_id, name, description, deprecated, namespace, created, updated, user]","default":""},"name":"sort","in":"query"},{"description":"comma-separated list of filtering criteria. Element is `key:encoded-value` where the `encoded-value` is a URL-encoded expression describing [for strings] a partial match (i.e. evaluated like shell glob `*value*` but case-insensitive); [for dates] an exact match. Supported keys are the fields: [parser_id, name, description, namespace, created, updated, user] ","required":false,"schema":{"title":"Filter","type":"string","description":"comma-separated list of filtering criteria. Element is `key:encoded-value` where the `encoded-value` is a URL-encoded expression describing [for strings] a partial match (i.e. evaluated like shell glob `*value*` but case-insensitive); [for dates] an exact match. Supported keys are the fields: [parser_id, name, description, namespace, created, updated, user] ","default":""},"name":"filter","in":"query"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DDISParser_qry_resp"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["parser"],"summary":"Upload Parser","description":"Upload a new parser. If the overwrite param is set to true, the upload can\noverwrite an existing parser; otherwise, the upload fails if the parser\nalready exists.\n\nThe system privilege is required for all parser uploads.","operationId":"upload_parser","parameters":[{"required":false,"schema":{"title":"Overwrite file (default False)","type":"boolean","default":false},"name":"overwrite","in":"query"},{"required":false,"schema":{"title":"Namespace [system privilege required to update]","type":"string"},"name":"namespace","in":"query"}],"requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_upload_parser"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ParserId"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/parsers/{parser_id}":{"get":{"tags":["parser"],"summary":"Get Parser","description":"Download the source of a particular parser by ID.","operationId":"get_parser","parameters":[{"required":true,"schema":{"title":"Parser ID (UUID)","type":"string"},"example":"8e96072c-3541-11ee-ab8d-2b1d544a9521","name":"parser_id","in":"path"}],"responses":{"200":{"description":"Successful Response","content":{"text/x-python":{"schema":{"type":"string"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["parser"],"summary":"Delete Parser","description":"Delete the parser with the specified ID.","operationId":"delete_parser","parameters":[{"required":true,"schema":{"title":"Parser ID (UUID)","type":"string"},"example":"8e96072c-3541-11ee-ab8d-2b1d544a9521","name":"parser_id","in":"path"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ParserId"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/jobs/":{"get":{"tags":["job"],"summary":"List Jobs","description":"Endpoint for querying the Jobs table.\nSupports pagination and sorting.","operationId":"list_jobs","parameters":[{"description":"how many results per page (integer; 0 or unspecified => 100)","required":false,"schema":{"title":"Page Size","minimum":0.0,"type":"integer","description":"how many results per page (integer; 0 or unspecified => 100)","default":0},"name":"page_size","in":"query"},{"description":"which page of results (integer; default 0)","required":false,"schema":{"title":"Page Number","minimum":0.0,"type":"integer","description":"which page of results (integer; default 0)","default":0},"name":"page_number","in":"query"},{"description":"comma-separated list of field name keys to sort on (default unsorted, optionally suffix with :asc [default] or :desc to specify sorting direction). Supported keys [user, created, updated, name, retention, description, job_type, parser_id, network_id, confidence, observer, mapping, selectors, preview, create_new_assets, clear_overrides, priority_import, no_expiration_addresses, remove_other_assignments, job_id, completed, step, job_status, direct_to_dots]","required":false,"schema":{"title":"Sort","type":"string","description":"comma-separated list of field name keys to sort on (default unsorted, optionally suffix with :asc [default] or :desc to specify sorting direction). Supported keys [user, created, updated, name, retention, description, job_type, parser_id, network_id, confidence, observer, mapping, selectors, preview, create_new_assets, clear_overrides, priority_import, no_expiration_addresses, remove_other_assignments, job_id, completed, step, job_status, direct_to_dots]","default":""},"name":"sort","in":"query"},{"description":"comma-separated list of filtering criteria. Element is `key:encoded-value` where the `encoded-value` is a URL-encoded expression describing [for strings] a partial match (i.e. evaluated like shell glob `*value*` but case-insensitive); [for dates] an exact match. Supported keys are the fields: [user, created, updated, name, description, job_type, parser_id, network_id, observer, job_id, completed, step, job_status] ","required":false,"schema":{"title":"Filter","type":"string","description":"comma-separated list of filtering criteria. Element is `key:encoded-value` where the `encoded-value` is a URL-encoded expression describing [for strings] a partial match (i.e. evaluated like shell glob `*value*` but case-insensitive); [for dates] an exact match. Supported keys are the fields: [user, created, updated, name, description, job_type, parser_id, network_id, observer, job_id, completed, step, job_status] ","default":""},"name":"filter","in":"query"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DDISJob_qry_resp"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["job"],"summary":"Create Job","description":"Create a row in the ddis_jobs table for this job_id.\nCreate the underlying directories for this job type.\n\nJob config required fields: job_type, parser_id, confidence, network_id.","operationId":"create_job","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DDISJobConfigBase"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DDISJobId"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/jobs/{job_id}":{"get":{"tags":["job"],"summary":"Get Job","description":"Get a job by ID.","operationId":"get_job","parameters":[{"required":true,"schema":{"title":"Job ID (UUID)","type":"string"},"example":"8c967bd2-37ad-11ee-a010-5f1442ea8b72","name":"job_id","in":"path"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DDISJob"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["job"],"summary":"Update Job","description":"Update job-config for this job.","operationId":"update_job","parameters":[{"required":true,"schema":{"title":"Job ID (UUID)","type":"string"},"example":"8c967bd2-37ad-11ee-a010-5f1442ea8b72","name":"job_id","in":"path"}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DDISJobConfigBase"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DDISJobId"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["job"],"summary":"Delete Job","description":"Delete a job by ID.\n\nDeletes the underlying files created for the job including\n    - any parsed data\n    - the source file\n    - any mapped files\nDeletes references in the ddis_files table","operationId":"delete_job","parameters":[{"required":true,"schema":{"title":"Job ID (UUID)","type":"string"},"example":"8c967bd2-37ad-11ee-a010-5f1442ea8b72","name":"job_id","in":"path"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DDISJobId"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/jobs/{job_id}/continue":{"post":{"tags":["job"],"summary":"Continue Job","description":"Continue job from given step or current step.","operationId":"continue_job","parameters":[{"required":true,"schema":{"title":"Job ID (UUID)","type":"string"},"example":"8c967bd2-37ad-11ee-a010-5f1442ea8b72","name":"job_id","in":"path"},{"required":false,"schema":{"title":"step ID (if omitted, start with parsing)","allOf":[{"$ref":"#/components/schemas/DDISJobStep"}],"default":"PARSE"},"example":"MAP","name":"step_id","in":"query"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/jobs/{job_id}/stop":{"post":{"tags":["job"],"summary":"Stop Job","description":"Stop running job.\nSucceeds (returning 202) if the job is actually running in the background.\nFails (returning 404) if the job is not valid.\nFails (returning 409) if the job is a valid job, but is not currently running.","operationId":"stop_job","parameters":[{"required":true,"schema":{"title":"Job ID (UUID)","type":"string"},"example":"8c967bd2-37ad-11ee-a010-5f1442ea8b72","name":"job_id","in":"path"}],"responses":{"202":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/jobs/{job_id}/wait":{"post":{"tags":["job"],"summary":"Wait For Job","description":"Wait for the given job to reach either a PAUSED or DONE status.\nOptional timeout argument:\n    Wait \"forever\" if omitted\n    Wait up to timeout seconds\nReturns 200 if completed.\nReturns 404 if job not found\nReturns 409 if job is not running\nReturns 408 if the wait times out\n\nNote that background tasks are inherently asynchronous from the caller\npoint of view (hence racy) so you should be prepared for the 409 status\n(i.e. job might have finished and no longer be running before your wait\nrequest arrived).","operationId":"wait_for_job","parameters":[{"required":true,"schema":{"title":"Job ID (UUID)","type":"string"},"example":"8c967bd2-37ad-11ee-a010-5f1442ea8b72","name":"job_id","in":"path"},{"required":false,"schema":{"title":"Timeout in seconds (forever if omitted)","exclusiveMinimum":0.0,"type":"number"},"name":"timeout","in":"query"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/jobs/get_mapping_columns_by_job_type/{job_type}/":{"get":{"tags":["job"],"summary":"Get Mapping Columns By Job Type","description":"Get the RHS (right-hand-side) column names corresponding to the given\njob_type (if any). Each has a flattened field name and an indicator whether\nit may be used as a \"selector\" in asset enrichment.","operationId":"get_mapping_columns_by_job_type","parameters":[{"required":true,"schema":{"$ref":"#/components/schemas/JobType"},"name":"job_type","in":"path"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DotsColumns"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/jobs/{job_id}/mapping-params":{"get":{"tags":["job"],"summary":"Get Job Mapping Params","description":"Get the fields necessary for a user to create a custom mapping.\n\nlhc = Left Hand Column\nrhc = Right Hand Column\n\nThe lhc are the headers found during the parsing operation\nThe rhc are the possible DOTS fields to map to\n\nSo you might have a lhc field named my.host which maps to a rhc (DOTS) field host.name","operationId":"get_job_mapping_params","parameters":[{"required":true,"schema":{"title":"Job ID (UUID)","type":"string"},"example":"8c967bd2-37ad-11ee-a010-5f1442ea8b72","name":"job_id","in":"path"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MappingParams"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/jobs/{job_id}/enrichment-columns":{"get":{"tags":["job"],"summary":"Get Enrichment Columns","description":"Get the fields represented in enrichment output.","operationId":"enrichment_columns","parameters":[{"required":true,"schema":{"title":"Job ID (UUID)","type":"string"},"example":"8c967bd2-37ad-11ee-a010-5f1442ea8b72","name":"job_id","in":"path"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"title":"Response Enrichment Columns","type":"array","items":{}}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/jobs/data/{job_id}":{"post":{"tags":["job"],"summary":"Get Job Step Data","description":"Search function for data in the pipeline.\nData types will be data objects or errors from various steps in the pipeline.","operationId":"get_job_step_data","parameters":[{"required":true,"schema":{"title":"Job ID (UUID)","type":"string"},"example":"8c967bd2-37ad-11ee-a010-5f1442ea8b72","name":"job_id","in":"path"},{"required":false,"schema":{"title":"Limit","type":"integer","default":50},"name":"limit","in":"query"},{"required":false,"schema":{"title":"Offset","type":"integer","default":0},"name":"offset","in":"query"}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/StepDataDetails"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"title":"Response Get Job Step Data","type":"object"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/configs/":{"get":{"tags":["job_config"],"summary":"List Job Configs","description":"Endpoint for querying the job configs table.\nSupports pagination and sorting.","operationId":"list_job_configs","parameters":[{"description":"how many results per page (integer; 0 or unspecified => 100)","required":false,"schema":{"title":"Page Size","minimum":0.0,"type":"integer","description":"how many results per page (integer; 0 or unspecified => 100)","default":0},"name":"page_size","in":"query"},{"description":"which page of results (integer; default 0)","required":false,"schema":{"title":"Page Number","minimum":0.0,"type":"integer","description":"which page of results (integer; default 0)","default":0},"name":"page_number","in":"query"},{"description":"comma-separated list of field name keys to sort on (default unsorted, optionally suffix with :asc [default] or :desc to specify sorting direction). Supported keys [user, created, updated, name, retention, description, job_type, parser_id, network_id, confidence, observer, mapping, selectors, preview, create_new_assets, clear_overrides, priority_import, no_expiration_addresses, remove_other_assignments, draft, config_id]","required":false,"schema":{"title":"Sort","type":"string","description":"comma-separated list of field name keys to sort on (default unsorted, optionally suffix with :asc [default] or :desc to specify sorting direction). Supported keys [user, created, updated, name, retention, description, job_type, parser_id, network_id, confidence, observer, mapping, selectors, preview, create_new_assets, clear_overrides, priority_import, no_expiration_addresses, remove_other_assignments, draft, config_id]","default":""},"name":"sort","in":"query"},{"description":"comma-separated list of filtering criteria. Element is `key:encoded-value` where the `encoded-value` is a URL-encoded expression describing [for strings] a partial match (i.e. evaluated like shell glob `*value*` but case-insensitive); [for dates] an exact match. Supported keys are the fields: [user, created, updated, name, description, job_type, parser_id, network_id, observer, config_id] ","required":false,"schema":{"title":"Filter","type":"string","description":"comma-separated list of filtering criteria. Element is `key:encoded-value` where the `encoded-value` is a URL-encoded expression describing [for strings] a partial match (i.e. evaluated like shell glob `*value*` but case-insensitive); [for dates] an exact match. Supported keys are the fields: [user, created, updated, name, description, job_type, parser_id, network_id, observer, config_id] ","default":""},"name":"filter","in":"query"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DDISJobConfigQuery_qry_resp"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["job_config"],"summary":"Create Job Config","description":"Create a job config.\n\nRequired fields: Name.","operationId":"create_job_config","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DDISJobConfig"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DDISJobConfigId"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/configs/{config_id}":{"get":{"tags":["job_config"],"summary":"Get Job Config","description":"Get an existing job config","operationId":"get_job_config","parameters":[{"required":true,"schema":{"title":"Job Config ID (UUID)","type":"string"},"example":"51be6a1e-3556-11ee-b846-676e4b0bea7f","name":"config_id","in":"path"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DDISJobConfigQuery"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["job_config"],"summary":"Update Job Config","description":"Update an existing job config","operationId":"update_job_config","parameters":[{"required":true,"schema":{"title":"Job Config ID (UUID)","type":"string"},"example":"51be6a1e-3556-11ee-b846-676e4b0bea7f","name":"config_id","in":"path"}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DDISJobConfig"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DDISJobConfigId"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["job_config"],"summary":"Delete Job Config","description":"Delete a job config","operationId":"delete_job_config","parameters":[{"required":true,"schema":{"title":"Job Config ID (UUID)","type":"string"},"example":"51be6a1e-3556-11ee-b846-676e4b0bea7f","name":"config_id","in":"path"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DDISJobConfigId"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/files/job_id/{job_id}":{"get":{"tags":["file_metadata"],"summary":"Get File Metadata Job Id","description":"Get the file metadata associated with a job ID","operationId":"get_file_metadata_job_id","parameters":[{"required":true,"schema":{"title":"Job ID (UUID)","type":"string"},"example":"8c967bd2-37ad-11ee-a010-5f1442ea8b72","name":"job_id","in":"path"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"title":"Response Get File Metadata Job Id","type":"array","items":{"$ref":"#/components/schemas/DDISFile"}}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/files/":{"get":{"tags":["file_metadata"],"summary":"List File Metadata","description":"Get a paginated list of files in the system","operationId":"list_file_metadata","parameters":[{"description":"how many results per page (integer; 0 or unspecified => 100)","required":false,"schema":{"title":"Page Size","minimum":0.0,"type":"integer","description":"how many results per page (integer; 0 or unspecified => 100)","default":0},"name":"page_size","in":"query"},{"description":"which page of results (integer; default 0)","required":false,"schema":{"title":"Page Number","minimum":0.0,"type":"integer","description":"which page of results (integer; default 0)","default":0},"name":"page_number","in":"query"},{"description":"comma-separated list of field name keys to sort on (default unsorted, optionally suffix with :asc [default] or :desc to specify sorting direction). Supported keys [job_id, file_id, created, file_name, file_type, complete]","required":false,"schema":{"title":"Sort","type":"string","description":"comma-separated list of field name keys to sort on (default unsorted, optionally suffix with :asc [default] or :desc to specify sorting direction). Supported keys [job_id, file_id, created, file_name, file_type, complete]","default":""},"name":"sort","in":"query"},{"description":"comma-separated list of filtering criteria. Element is `key:encoded-value` where the `encoded-value` is a URL-encoded expression describing [for strings] a partial match (i.e. evaluated like shell glob `*value*` but case-insensitive); [for dates] an exact match. Supported keys are the fields: [job_id, file_id, created, file_name, file_type] ","required":false,"schema":{"title":"Filter","type":"string","description":"comma-separated list of filtering criteria. Element is `key:encoded-value` where the `encoded-value` is a URL-encoded expression describing [for strings] a partial match (i.e. evaluated like shell glob `*value*` but case-insensitive); [for dates] an exact match. Supported keys are the fields: [job_id, file_id, created, file_name, file_type] ","default":""},"name":"filter","in":"query"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DDISFile_qry_resp"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["file_metadata"],"summary":"Create Upload","description":"Create a new upload","operationId":"create_upload","parameters":[{"description":"Upload metadata; comma-separated key-value pairs, value is base64-encoded;\n- job_id: (required) from create_job\n- filename: name of file being uploaded\n- filetype: MIME type of file (text/csv, etc.)\n- filepath: full path to file uploaded","required":true,"schema":{"title":"Upload-Metadata","type":"string","description":"Upload metadata; comma-separated key-value pairs, value is base64-encoded;\n- job_id: (required) from create_job\n- filename: name of file being uploaded\n- filetype: MIME type of file (text/csv, etc.)\n- filepath: full path to file uploaded"},"example":"Upload-Metadata: job_id NmZjY2IyNDQtNzkxZS00ODVhLTllNWEtMTgxMTgzMWM4NTQw,filename b3VpLmNzdg==,filetype dGV4dC9jc3Y=,filepath b3VpLmNzdg==","name":"upload-metadata","in":"header"},{"required":true,"schema":{"title":"Upload-Length","type":"integer"},"name":"upload-length","in":"header"},{"required":false,"schema":{"title":"Upload-Defer-Length","type":"integer"},"name":"upload-defer-length","in":"header"},{"required":false,"schema":{"title":"Dragos-Internal-Service-Network","type":"string"},"name":"dragos-internal-service-network","in":"header"}],"responses":{"201":{"description":"Successful Response","headers":{"Content-Length":{"schema":{"type":"integer"}},"Tus-Resumable":{"schema":{"type":"string"}},"Location":{"schema":{"type":"string"}}},"content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"options":{"tags":["file_metadata"],"summary":"Options Create Upload","description":"Obtain TUS options, extensions, etc.","operationId":"get_tus_info","responses":{"204":{"description":"Successful Response","headers":{"Tus-Extension":{"schema":{"type":"string"}},"Tus-Resumable":{"schema":{"type":"string"}},"Tus-Version":{"schema":{"type":"string"}},"Tus-Max-Size":{"schema":{"type":"integer"}},"Content-Length":{"schema":{"type":"integer"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/files/{file_id}":{"get":{"tags":["file_metadata"],"summary":"Get Upload Data","description":"Download uploaded file.\nThis is a File response","operationId":"get_upload_data","parameters":[{"required":true,"schema":{"title":"File Id","type":"string"},"name":"file_id","in":"path"}],"responses":{"200":{"description":"Successful Response","headers":{"Tus-Resumable":{"schema":{"type":"string"}},"Content-Length":{"schema":{"type":"integer"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["file_metadata"],"summary":"Delete File","description":"Delete a file by ID.\n\nDeletes the source file associated with a job, so a new source file can be\nused.\n- Deletes references in the ddis_files table.\n- Deletes the file from disk.","operationId":"delete_file","parameters":[{"required":true,"schema":{"title":"File Id","type":"string"},"name":"file_id","in":"path"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DDISFileId"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"options":{"tags":["file_metadata"],"summary":"Get Upload Info","description":"Check whether upload exists","operationId":"get_upload_info","parameters":[{"required":true,"schema":{"title":"File Id","type":"string"},"name":"file_id","in":"path"}],"responses":{"204":{"description":"Successful Response","headers":{"Tus-Extension":{"schema":{"type":"string"}},"Tus-Resumable":{"schema":{"type":"string"}},"Tus-Version":{"schema":{"type":"string"}},"Content-Length":{"schema":{"type":"integer"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"head":{"tags":["file_metadata"],"summary":"Get Upload Metadata","description":"Obtain information about existing paused/broken upload","operationId":"get_upload_metadata","parameters":[{"required":true,"schema":{"title":"File Id","type":"string"},"name":"file_id","in":"path"}],"responses":{"204":{"description":"Successful Response","headers":{"Tus-Resumable":{"schema":{"type":"string"}},"Content-Length":{"schema":{"type":"integer"}},"Upload-Length":{"schema":{"type":"integer"}},"Upload-Offset":{"schema":{"type":"integer"}},"Upload-Metadata":{"description":"Upload metadata; comma-separated key-value pairs, value is base64-encoded;\n- job_id: (required) from create_job\n- filename: name of file being uploaded\n- filetype: MIME type of file (text/csv, etc.)\n- filepath: full path to file uploaded","schema":{"type":"string"},"example":"Upload-Metadata: job_id NmZjY2IyNDQtNzkxZS00ODVhLTllNWEtMTgxMTgzMWM4NTQw,filename b3VpLmNzdg==,filetype dGV4dC9jc3Y=,filepath b3VpLmNzdg=="}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"patch":{"tags":["file_metadata"],"summary":"Upload Chunk","description":"Provide all or part of the uploaded file contents","operationId":"upload_chunk","parameters":[{"required":true,"schema":{"title":"File Id","type":"string"},"name":"file_id","in":"path"},{"required":true,"schema":{"title":"Content-Type","type":"string"},"name":"content-type","in":"header"},{"required":true,"schema":{"title":"Content-Length","type":"integer"},"name":"content-length","in":"header"},{"required":true,"schema":{"title":"Upload-Offset","type":"integer"},"name":"upload-offset","in":"header"}],"responses":{"204":{"description":"Successful Response","headers":{"Upload-Offset":{"schema":{"type":"integer"}},"Tus-Resumable":{"schema":{"type":"string"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/settings/":{"get":{"tags":["settings"],"summary":"Get Settings","description":"Get settings","operationId":"get_settings","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"title":"Response Get Settings","type":"object"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"Body_upload_parser":{"title":"Body_upload_parser","required":["file"],"type":"object","properties":{"file":{"title":"File","type":"string","format":"binary"}}},"DDISFile":{"title":"DDISFile","required":["file_id","created","file_name","file_type","complete"],"type":"object","properties":{"job_id":{"title":"Job ID (UUID)","type":"string","example":"8c967bd2-37ad-11ee-a010-5f1442ea8b72"},"file_id":{"title":"File Id (UUID)","type":"string","example":"969f696e-3626-11ee-81d8-237276a88c02"},"created":{"title":"File creation time","type":"string","format":"date-time"},"file_name":{"title":"File name","type":"string"},"file_type":{"title":"File type [MIME type]","type":"string"},"complete":{"title":"Complete","type":"boolean"}}},"DDISFileId":{"title":"DDISFileId","required":["file_id"],"type":"object","properties":{"file_id":{"title":"File Id (UUID)","type":"string","example":"969f696e-3626-11ee-81d8-237276a88c02"}}},"DDISFile_qry_resp":{"title":"DDISFile_qry_resp","required":["page_number","page_size","total_count","content"],"type":"object","properties":{"page_number":{"title":"Page Number","type":"integer"},"page_size":{"title":"Page Size","type":"integer"},"total_count":{"title":"Total Count","type":"integer"},"content":{"title":"Content","type":"array","items":{"$ref":"#/components/schemas/DDISFile"}}}},"DDISJob":{"title":"DDISJob","required":["user","created","updated","step","job_status","direct_to_dots"],"type":"object","properties":{"user":{"title":"User","type":"string","description":"Name of creating/updating user"},"created":{"title":"Mapping creation time","type":"string","format":"date-time"},"updated":{"title":"Mapping last-updated time","type":"string","format":"date-time"},"name":{"title":"Job Config name","maxLength":64,"type":"string"},"retention":{"title":"Hours duration to keep files, errors and outputs of job","maximum":8766.0,"minimum":0.0,"type":"integer","default":48},"description":{"title":"Job description","maxLength":2048,"type":"string"},"job_type":{"$ref":"#/components/schemas/JobType"},"parser_id":{"title":"Parser ID (UUID)","type":"string","example":"8e96072c-3541-11ee-ab8d-2b1d544a9521"},"network_id":{"title":"Network ID","type":"string","example":"64d08769cfe28106d0862904"},"confidence":{"title":"Confidence setting for import data observations (1-255)","maximum":255.0,"minimum":1.0,"type":"integer","example":60},"observer":{"title":"Observer/Source name if not present in mapped output","type":"string"},"mapping":{"title":"Mapping of LHS columns to RHS columns (or null to omit mapping)","type":"object","additionalProperties":{"type":"string"}},"selectors":{"title":"Selectors required for Asset Enrichment","type":"array","items":{"type":"string"}},"preview":{"title":"Preview flag","type":"boolean","description":"If set, import will stop for preview following enrichment step"},"create_new_assets":{"title":"Create new assets flag","type":"boolean","description":"If set, new assets will be created when no matching asset is found"},"clear_overrides":{"title":"Clear overrides flag","type":"boolean","description":"If set, relevant, existing override values on assets will be cleared"},"priority_import":{"title":"(DEPRECATED) Priority import flag","type":"boolean","description":"(DEPRECATED) All import jobs are effectively priority imports. This flag is ignored."},"no_expiration_addresses":{"title":"Addresses expiration flag","type":"boolean","description":"If set, imported addresses will be set to not expire"},"remove_other_assignments":{"title":"Software Replace or Add Flag","type":"boolean","description":"If set to True, imported software packages will overwrite packages previously assigned to an asset"},"job_id":{"title":"Job ID (UUID)","type":"string","example":"8c967bd2-37ad-11ee-a010-5f1442ea8b72"},"completed":{"title":"Job completion time","type":"string","format":"date-time"},"step":{"$ref":"#/components/schemas/DDISJobStep"},"job_status":{"$ref":"#/components/schemas/DDISJobStatus"},"direct_to_dots":{"title":"Mapping flag","type":"boolean","description":"If set, parser outputs to dots"}},"description":"Data Import Service Job"},"DDISJobConfig":{"title":"DDISJobConfig","type":"object","properties":{"name":{"title":"Job Config name","maxLength":64,"type":"string"},"retention":{"title":"Hours duration to keep files, errors and outputs of job","maximum":8766.0,"minimum":0.0,"type":"integer","default":48},"description":{"title":"Job description","maxLength":2048,"type":"string"},"job_type":{"$ref":"#/components/schemas/JobType"},"parser_id":{"title":"Parser ID (UUID)","type":"string","example":"8e96072c-3541-11ee-ab8d-2b1d544a9521"},"network_id":{"title":"Network ID","type":"string","example":"64d08769cfe28106d0862904"},"confidence":{"title":"Confidence setting for import data observations (1-255)","maximum":255.0,"minimum":1.0,"type":"integer","example":60},"observer":{"title":"Observer/Source name if not present in mapped output","type":"string"},"mapping":{"title":"Mapping of LHS columns to RHS columns (or null to omit mapping)","type":"object","additionalProperties":{"type":"string"}},"selectors":{"title":"Selectors required for Asset Enrichment","type":"array","items":{"type":"string"}},"preview":{"title":"Preview flag","type":"boolean","description":"If set, import will stop for preview following enrichment step"},"create_new_assets":{"title":"Create new assets flag","type":"boolean","description":"If set, new assets will be created when no matching asset is found"},"clear_overrides":{"title":"Clear overrides flag","type":"boolean","description":"If set, relevant, existing override values on assets will be cleared"},"priority_import":{"title":"(DEPRECATED) Priority import flag","type":"boolean","description":"(DEPRECATED) All import jobs are effectively priority imports. This flag is ignored."},"no_expiration_addresses":{"title":"Addresses expiration flag","type":"boolean","description":"If set, imported addresses will be set to not expire"},"remove_other_assignments":{"title":"Software Replace or Add Flag","type":"boolean","description":"If set to True, imported software packages will overwrite packages previously assigned to an asset"},"draft":{"title":"Draft flag","type":"boolean","description":"Object still under construction -- cannot be used for importing"}},"description":"Job configuration"},"DDISJobConfigBase":{"title":"DDISJobConfigBase","type":"object","properties":{"name":{"title":"Job Config name","maxLength":64,"type":"string"},"retention":{"title":"Hours duration to keep files, errors and outputs of job","maximum":8766.0,"minimum":0.0,"type":"integer","default":48},"description":{"title":"Job description","maxLength":2048,"type":"string"},"job_type":{"$ref":"#/components/schemas/JobType"},"parser_id":{"title":"Parser ID (UUID)","type":"string","example":"8e96072c-3541-11ee-ab8d-2b1d544a9521"},"network_id":{"title":"Network ID","type":"string","example":"64d08769cfe28106d0862904"},"confidence":{"title":"Confidence setting for import data observations (1-255)","maximum":255.0,"minimum":1.0,"type":"integer","example":60},"observer":{"title":"Observer/Source name if not present in mapped output","type":"string"},"mapping":{"title":"Mapping of LHS columns to RHS columns (or null to omit mapping)","type":"object","additionalProperties":{"type":"string"}},"selectors":{"title":"Selectors required for Asset Enrichment","type":"array","items":{"type":"string"}},"preview":{"title":"Preview flag","type":"boolean","description":"If set, import will stop for preview following enrichment step"},"create_new_assets":{"title":"Create new assets flag","type":"boolean","description":"If set, new assets will be created when no matching asset is found"},"clear_overrides":{"title":"Clear overrides flag","type":"boolean","description":"If set, relevant, existing override values on assets will be cleared"},"priority_import":{"title":"(DEPRECATED) Priority import flag","type":"boolean","description":"(DEPRECATED) All import jobs are effectively priority imports. This flag is ignored."},"no_expiration_addresses":{"title":"Addresses expiration flag","type":"boolean","description":"If set, imported addresses will be set to not expire"},"remove_other_assignments":{"title":"Software Replace or Add Flag","type":"boolean","description":"If set to True, imported software packages will overwrite packages previously assigned to an asset"}},"description":"Parts of the job configuration shared by the JobConfig and the Job"},"DDISJobConfigId":{"title":"DDISJobConfigId","required":["config_id"],"type":"object","properties":{"config_id":{"title":"Job Config ID (UUID)","type":"string","example":"51be6a1e-3556-11ee-b846-676e4b0bea7f"}}},"DDISJobConfigQuery":{"title":"DDISJobConfigQuery","required":["user","created","updated","config_id"],"type":"object","properties":{"user":{"title":"User","type":"string","description":"Name of creating/updating user"},"created":{"title":"Mapping creation time","type":"string","format":"date-time"},"updated":{"title":"Mapping last-updated time","type":"string","format":"date-time"},"name":{"title":"Job Config name","maxLength":64,"type":"string"},"retention":{"title":"Hours duration to keep files, errors and outputs of job","maximum":8766.0,"minimum":0.0,"type":"integer","default":48},"description":{"title":"Job description","maxLength":2048,"type":"string"},"job_type":{"$ref":"#/components/schemas/JobType"},"parser_id":{"title":"Parser ID (UUID)","type":"string","example":"8e96072c-3541-11ee-ab8d-2b1d544a9521"},"network_id":{"title":"Network ID","type":"string","example":"64d08769cfe28106d0862904"},"confidence":{"title":"Confidence setting for import data observations (1-255)","maximum":255.0,"minimum":1.0,"type":"integer","example":60},"observer":{"title":"Observer/Source name if not present in mapped output","type":"string"},"mapping":{"title":"Mapping of LHS columns to RHS columns (or null to omit mapping)","type":"object","additionalProperties":{"type":"string"}},"selectors":{"title":"Selectors required for Asset Enrichment","type":"array","items":{"type":"string"}},"preview":{"title":"Preview flag","type":"boolean","description":"If set, import will stop for preview following enrichment step"},"create_new_assets":{"title":"Create new assets flag","type":"boolean","description":"If set, new assets will be created when no matching asset is found"},"clear_overrides":{"title":"Clear overrides flag","type":"boolean","description":"If set, relevant, existing override values on assets will be cleared"},"priority_import":{"title":"(DEPRECATED) Priority import flag","type":"boolean","description":"(DEPRECATED) All import jobs are effectively priority imports. This flag is ignored."},"no_expiration_addresses":{"title":"Addresses expiration flag","type":"boolean","description":"If set, imported addresses will be set to not expire"},"remove_other_assignments":{"title":"Software Replace or Add Flag","type":"boolean","description":"If set to True, imported software packages will overwrite packages previously assigned to an asset"},"draft":{"title":"Draft flag","type":"boolean","description":"Object still under construction -- cannot be used for importing"},"config_id":{"title":"Job Config ID (UUID)","type":"string","example":"51be6a1e-3556-11ee-b846-676e4b0bea7f"}},"description":"Query-able Job configuration"},"DDISJobConfigQuery_qry_resp":{"title":"DDISJobConfigQuery_qry_resp","required":["page_number","page_size","total_count","content"],"type":"object","properties":{"page_number":{"title":"Page Number","type":"integer"},"page_size":{"title":"Page Size","type":"integer"},"total_count":{"title":"Total Count","type":"integer"},"content":{"title":"Content","type":"array","items":{"$ref":"#/components/schemas/DDISJobConfigQuery"}}}},"DDISJobId":{"title":"DDISJobId","type":"object","properties":{"job_id":{"title":"Job ID (UUID)","type":"string","example":"8c967bd2-37ad-11ee-a010-5f1442ea8b72"}}},"DDISJobStatus":{"title":"DDISJobStatus","enum":["PAUSED","STOPPED","IN_PROGRESS","DONE","ERROR"],"description":"DDIS Job Step Status\n\nEach step can be:\n- PAUSED (ready to begin this step, but administratively paused)\n- STOPPED (job step canceled while running; can be restarted)\n- IN_PROGRESS (job running in background)\n- DONE (job completed)\n- ERROR (step completed with error)"},"DDISJobStep":{"title":"DDISJobStep","enum":["INIT","UPLOAD","PARSE","MAP","ENRICH","ASSOC","ASSOC_SOFT","IMPORT","DONE"],"description":"Job Step. Ordering is significant."},"DDISJob_qry_resp":{"title":"DDISJob_qry_resp","required":["page_number","page_size","total_count","content"],"type":"object","properties":{"page_number":{"title":"Page Number","type":"integer"},"page_size":{"title":"Page Size","type":"integer"},"total_count":{"title":"Total Count","type":"integer"},"content":{"title":"Content","type":"array","items":{"$ref":"#/components/schemas/DDISJob"}}}},"DDISParser":{"title":"DDISParser","required":["parser_id","name","deprecated","required_file_types","outputs_dots","created","updated","user"],"type":"object","properties":{"parser_id":{"title":"Parser ID (UUID)","type":"string","example":"8e96072c-3541-11ee-ab8d-2b1d544a9521"},"name":{"title":"Parser name","maxLength":64,"type":"string"},"description":{"title":"Parser description","maxLength":2048,"type":"string"},"deprecated":{"title":"Parser deprecated","type":"boolean"},"required_file_types":{"title":"Required File Types","type":"array","items":{"$ref":"#/components/schemas/RequiredFile"}},"outputs_dots":{"title":"Flag: Parser produces (already-mapped) DOTS output","type":"boolean"},"namespace":{"title":"Namespace","type":"string","description":"Namespace of owning component"},"created":{"title":"Object creation time","type":"string","format":"date-time"},"updated":{"title":"Object last-updated time","type":"string","format":"date-time"},"user":{"title":"User","type":"string","description":"Name of creating/updating user"}},"description":"All parser fields"},"DDISParser_qry_resp":{"title":"DDISParser_qry_resp","required":["page_number","page_size","total_count","content"],"type":"object","properties":{"page_number":{"title":"Page Number","type":"integer"},"page_size":{"title":"Page Size","type":"integer"},"total_count":{"title":"Total Count","type":"integer"},"content":{"title":"Content","type":"array","items":{"$ref":"#/components/schemas/DDISParser"}}}},"DataTypes":{"title":"DataTypes","enum":["output","errors","fatal","all"],"description":"An enumeration."},"DotsColumns":{"title":"DotsColumns","required":["columns"],"type":"object","properties":{"columns":{"title":"DOTS mapping names","type":"array","items":{"$ref":"#/components/schemas/MappingColumn"}}},"description":"Descriptor for mapping RHS"},"HTTPValidationError":{"title":"HTTPValidationError","type":"object","properties":{"detail":{"title":"Detail","type":"array","items":{"$ref":"#/components/schemas/ValidationError"}}}},"JobType":{"title":"JobType","enum":["ASSET","SBOM","UNSTRUCTURED"],"description":"Import Job Type"},"MappingColumn":{"title":"MappingColumn","required":["name","is_selector"],"type":"object","properties":{"name":{"title":"Column name (flattened)","type":"string"},"is_selector":{"title":"Column is valid selector","type":"boolean"}}},"MappingParams":{"title":"MappingParams","required":["lhc","rhc"],"type":"object","properties":{"lhc":{"title":"Left hand columns","type":"array","items":{"type":"string"}},"rhc":{"title":"Right hand (DOTS Observed Asset) columns","type":"array","items":{"type":"string"}}}},"ParserId":{"title":"ParserId","required":["parser_id"],"type":"object","properties":{"parser_id":{"title":"Parser ID (UUID)","type":"string","example":"8e96072c-3541-11ee-ab8d-2b1d544a9521"}}},"PyVersion":{"title":"PyVersion","required":["major","minor","micro","releaselevel","serial"],"type":"object","properties":{"major":{"title":"Major","type":"integer"},"minor":{"title":"Minor","type":"integer"},"micro":{"title":"Micro","type":"integer"},"releaselevel":{"title":"Releaselevel","type":"string"},"serial":{"title":"Serial","type":"integer"}},"description":"Representation of the python release version"},"RequiredFile":{"title":"RequiredFile","required":["description","valid_file_extensions"],"type":"object","properties":{"description":{"title":"File type description","type":"string"},"valid_file_extensions":{"title":"List of file extensions satisfying this type","type":"array","items":{"type":"string"}}},"description":"The formal parser definition of required files"},"RootObject":{"title":"RootObject","required":["name","version","python_version","root_path"],"type":"object","properties":{"name":{"title":"Service name","type":"string"},"version":{"title":"Service version","type":"string"},"python_version":{"$ref":"#/components/schemas/PyVersion"},"root_path":{"title":"Configured HTTP root path","type":"string"}},"description":"Informational value returned by the root API"},"StepDataDetails":{"title":"StepDataDetails","required":["step","data_type"],"type":"object","properties":{"step":{"$ref":"#/components/schemas/DDISJobStep"},"data_type":{"$ref":"#/components/schemas/DataTypes"}}},"ValidationError":{"title":"ValidationError","required":["loc","msg","type"],"type":"object","properties":{"loc":{"title":"Location","type":"array","items":{"anyOf":[{"type":"string"},{"type":"integer"}]}},"msg":{"title":"Message","type":"string"},"type":{"title":"Error Type","type":"string"}}}}},"tags":[{"name":"file_metadata","description":"Files for a Import Jobs"},{"name":"job_config","description":"Import Job Configurations"},{"name":"job","description":"Import Jobs"},{"name":"parser","description":"Parsers for Import Jobs"},{"name":"settings","description":"Import Settings"}]}